
RuntimeError: mat1 and mat2 shapes cannot be multiplied (10240x1 and 9x64)
nohup: ignoring input
input cmd is:
	...python main.py --device cuda:0 --logs_save_dir /home/HaotianF/Exp/Results --experiment_description TS2Vec --method_name TS2Vec --run_description Epilepsy --training_mode self_supervised --seed 123 --selected_dataset Epilepsy

=============================================
Dataset: Epilepsy
Method:  TS2Vec
Mode:    self_supervised
=============================================
Training started ....

Epoch: 1 cost time: 24.8171 s
Train Loss     : 3.8068

Epoch: 2 cost time: 12.4563 s
Train Loss     : 3.5762

Epoch: 3 cost time: 11.0083 s
Train Loss     : 2.5629

Epoch: 4 cost time: 8.8663 s
Train Loss     : 2.0790

Epoch: 5 cost time: 8.9141 s
Train Loss     : 1.6258
Valid Loss     : 1.0722
Validation loss decreased (inf --> 1.072201).  Saving model ...

Epoch: 6 cost time: 9.3812 s
Train Loss     : 1.5022

Epoch: 7 cost time: 9.2039 s
Train Loss     : 1.3109

Epoch: 8 cost time: 8.5554 s
Train Loss     : 1.1064

Epoch: 9 cost time: 8.2655 s
Train Loss     : 1.2431

Epoch: 10 cost time: 9.2062 s
Train Loss     : 0.9613
Valid Loss     : 0.3648
Validation loss decreased (1.072201 --> 0.364751).  Saving model ...

Epoch: 11 cost time: 8.3378 s
Train Loss     : 0.8999

Epoch: 12 cost time: 8.4312 s
Train Loss     : 0.8141

Epoch: 13 cost time: 8.4123 s
Train Loss     : 0.8042

Epoch: 14 cost time: 9.4063 s
Train Loss     : 0.8637

Epoch: 15 cost time: 8.7497 s
Train Loss     : 0.6595
Valid Loss     : 0.2751
Validation loss decreased (0.364751 --> 0.275129).  Saving model ...

Epoch: 16 cost time: 8.7263 s
Train Loss     : 0.7710

Epoch: 17 cost time: 8.6120 s
Train Loss     : 0.6131

Epoch: 18 cost time: 8.7821 s
Train Loss     : 0.7499

Epoch: 19 cost time: 8.3985 s
Train Loss     : 0.6602

Epoch: 20 cost time: 8.6026 s
Train Loss     : 0.5302
Valid Loss     : 0.1619
Validation loss decreased (0.275129 --> 0.161946).  Saving model ...

Epoch: 21 cost time: 8.9282 s
Train Loss     : 0.6381

Epoch: 22 cost time: 8.7071 s
Train Loss     : 0.5955

Epoch: 23 cost time: 8.2266 s
Train Loss     : 0.6513

Epoch: 24 cost time: 8.6976 s
Train Loss     : 0.5399

Epoch: 25 cost time: 9.0806 s
Train Loss     : 0.4775
Valid Loss     : 0.1884
EarlyStopping counter: 1 out of 4

Epoch: 26 cost time: 8.6635 s
Train Loss     : 0.4622

Epoch: 27 cost time: 8.3284 s
Train Loss     : 0.4881

Epoch: 28 cost time: 8.8657 s
Train Loss     : 0.4581

Epoch: 29 cost time: 8.7225 s
Train Loss     : 0.4072

Epoch: 30 cost time: 8.2101 s
Train Loss     : 0.5211
Valid Loss     : 0.1978
EarlyStopping counter: 2 out of 4

Epoch: 31 cost time: 8.1542 s
Train Loss     : 0.5139

Epoch: 32 cost time: 9.0282 s
Train Loss     : 0.5367

Epoch: 33 cost time: 8.2488 s
Train Loss     : 0.5958

Epoch: 34 cost time: 8.6217 s
Train Loss     : 0.4002

Epoch: 35 cost time: 8.3670 s
Train Loss     : 0.5179
Valid Loss     : 0.1319
Validation loss decreased (0.161946 --> 0.131921).  Saving model ...

Epoch: 36 cost time: 8.6646 s
Train Loss     : 0.4155

Epoch: 37 cost time: 8.1163 s
Train Loss     : 0.4905

Epoch: 38 cost time: 8.2716 s
Train Loss     : 0.3190

Epoch: 39 cost time: 8.5939 s
Train Loss     : 0.4327

Epoch: 40 cost time: 8.6814 s
Train Loss     : 0.4109
Valid Loss     : 0.1186
Validation loss decreased (0.131921 --> 0.118611).  Saving model ...

Epoch: 41 cost time: 7.7542 s
Train Loss     : 0.5987

Epoch: 42 cost time: 8.1417 s
Train Loss     : 0.4574

Epoch: 43 cost time: 9.2399 s
Train Loss     : 0.5112

Epoch: 44 cost time: 8.0983 s
Train Loss     : 0.3447

Epoch: 45 cost time: 8.6546 s
Train Loss     : 0.4894
Valid Loss     : 0.1579
EarlyStopping counter: 1 out of 4

Epoch: 46 cost time: 8.3914 s
Train Loss     : 0.4416

Epoch: 47 cost time: 9.4458 s
Train Loss     : 0.3418

Epoch: 48 cost time: 8.5147 s
Train Loss     : 0.4085

Epoch: 49 cost time: 8.4584 s
Train Loss     : 0.4590

Epoch: 50 cost time: 8.2677 s
Train Loss     : 0.4014
Valid Loss     : 0.0916
Validation loss decreased (0.118611 --> 0.091603).  Saving model ...

Epoch: 51 cost time: 9.2684 s
Train Loss     : 0.4118

Epoch: 52 cost time: 8.3765 s
Train Loss     : 0.3337

Epoch: 53 cost time: 8.4522 s
Train Loss     : 0.4038

Epoch: 54 cost time: 8.4772 s
Train Loss     : 0.3447

Epoch: 55 cost time: 8.5209 s
Train Loss     : 0.4415
Valid Loss     : 0.1293
EarlyStopping counter: 1 out of 4

Epoch: 56 cost time: 7.9463 s
Train Loss     : 0.3595

Epoch: 57 cost time: 8.2087 s
Train Loss     : 0.4118

Epoch: 58 cost time: 8.7201 s
Train Loss     : 0.4626

Epoch: 59 cost time: 8.1496 s
Train Loss     : 0.3573

Epoch: 60 cost time: 8.1825 s
Train Loss     : 0.3742
Valid Loss     : 0.0735
Validation loss decreased (0.091603 --> 0.073535).  Saving model ...

Epoch: 61 cost time: 8.2305 s
Train Loss     : 0.4051

Epoch: 62 cost time: 9.3940 s
Train Loss     : 0.3305

Epoch: 63 cost time: 8.0144 s
Train Loss     : 0.3355

Epoch: 64 cost time: 8.0469 s
Train Loss     : 0.4444

Epoch: 65 cost time: 8.3706 s
Train Loss     : 0.4208
Valid Loss     : 0.1332
EarlyStopping counter: 1 out of 4

Epoch: 66 cost time: 9.2333 s
Train Loss     : 0.2899

Epoch: 67 cost time: 8.3844 s
Train Loss     : 0.3452

Epoch: 68 cost time: 8.7904 s
Train Loss     : 0.3476

Epoch: 69 cost time: 8.0866 s
Train Loss     : 0.3511

Epoch: 70 cost time: 9.0058 s
Train Loss     : 0.3145
Valid Loss     : 0.1143
EarlyStopping counter: 2 out of 4

Epoch: 71 cost time: 8.5330 s
Train Loss     : 0.3667

Epoch: 72 cost time: 8.5640 s
Train Loss     : 0.2690

Epoch: 73 cost time: 9.2442 s
Train Loss     : 0.4020

Epoch: 74 cost time: 8.2178 s
Train Loss     : 0.4213

Epoch: 75 cost time: 8.6681 s
Train Loss     : 0.3420
Valid Loss     : 0.1356
EarlyStopping counter: 3 out of 4

Epoch: 76 cost time: 9.3338 s
Train Loss     : 0.3719

Epoch: 77 cost time: 8.6631 s
Train Loss     : 0.3771

Epoch: 78 cost time: 8.9688 s
Train Loss     : 0.3065

Epoch: 79 cost time: 8.6882 s
Train Loss     : 0.2515

Epoch: 80 cost time: 9.5338 s
Train Loss     : 0.2546
Valid Loss     : 0.1077
EarlyStopping counter: 4 out of 4

Early stopping

################## Training is Done! #########################
Training time is : 0:12:08.417075



nohup: ignoring input
input cmd is:
	...python main.py --device cuda:0 --logs_save_dir /home/HaotianF/Exp/Results --experiment_description TS2Vec --method_name TS2Vec --run_description Epilepsy --training_mode train_linear --seed 123 --selected_dataset Epilepsy

=============================================
Dataset: Epilepsy
Method:  TS2Vec
Mode:    train_linear
=============================================
preparing exp...

Training started ....

Epoch: 1 cost time: 1.6935 s
Train Loss*     : 0.2723 | Train Acc     : 0.8932

Epoch: 2 cost time: 1.4321 s
Train Loss*     : 0.1218 | Train Acc     : 0.9520

Epoch: 3 cost time: 1.2732 s
Train Loss*     : 0.1130 | Train Acc     : 0.9555

Epoch: 4 cost time: 0.7893 s
Train Loss*     : 0.1068 | Train Acc     : 0.9568

Epoch: 5 cost time: 1.0013 s
Train Loss*     : 0.1030 | Train Acc     : 0.9583

Epoch: 6 cost time: 0.9375 s
Train Loss*     : 0.0982 | Train Acc     : 0.9609

Epoch: 7 cost time: 0.7571 s
Train Loss*     : 0.0991 | Train Acc     : 0.9609

Epoch: 8 cost time: 0.7472 s
Train Loss*     : 0.0951 | Train Acc     : 0.9622

Epoch: 9 cost time: 1.0478 s
Train Loss*     : 0.0941 | Train Acc     : 0.9640

Epoch: 10 cost time: 0.7665 s
Train Loss*     : 0.0947 | Train Acc     : 0.9635
Valid Loss     : 0.0834 | Valid Acc     : 0.9693
Validation loss decreased (inf --> 0.083400).  Saving model ...

Epoch: 11 cost time: 1.1231 s
Train Loss*     : 0.0931 | Train Acc     : 0.9642

Epoch: 12 cost time: 1.0691 s
Train Loss*     : 0.0920 | Train Acc     : 0.9653

Epoch: 13 cost time: 1.2356 s
Train Loss*     : 0.0938 | Train Acc     : 0.9630

Epoch: 14 cost time: 1.0307 s
Train Loss*     : 0.0999 | Train Acc     : 0.9619

Epoch: 15 cost time: 1.1963 s
Train Loss*     : 0.0951 | Train Acc     : 0.9660

Epoch: 16 cost time: 1.0736 s
Train Loss*     : 0.0920 | Train Acc     : 0.9660

Epoch: 17 cost time: 1.0617 s
Train Loss*     : 0.0873 | Train Acc     : 0.9675

Epoch: 18 cost time: 1.0374 s
Train Loss*     : 0.0854 | Train Acc     : 0.9693

Epoch: 19 cost time: 1.0697 s
Train Loss*     : 0.0868 | Train Acc     : 0.9679

Epoch: 20 cost time: 1.1005 s
Train Loss*     : 0.0981 | Train Acc     : 0.9609
Valid Loss     : 0.0872 | Valid Acc     : 0.9646
EarlyStopping counter: 1 out of 4

Epoch: 21 cost time: 1.0787 s
Train Loss*     : 0.0862 | Train Acc     : 0.9674

Epoch: 22 cost time: 1.1598 s
Train Loss*     : 0.0845 | Train Acc     : 0.9675

Epoch: 23 cost time: 0.9271 s
Train Loss*     : 0.0821 | Train Acc     : 0.9698

Epoch: 24 cost time: 1.0111 s
Train Loss*     : 0.0798 | Train Acc     : 0.9703

Epoch: 25 cost time: 0.8802 s
Train Loss*     : 0.0874 | Train Acc     : 0.9661

Epoch: 26 cost time: 1.0455 s
Train Loss*     : 0.0855 | Train Acc     : 0.9697

Epoch: 27 cost time: 0.8816 s
Train Loss*     : 0.0833 | Train Acc     : 0.9694

Epoch: 28 cost time: 1.4831 s
Train Loss*     : 0.0822 | Train Acc     : 0.9672

Epoch: 29 cost time: 1.0449 s
Train Loss*     : 0.0841 | Train Acc     : 0.9685

Epoch: 30 cost time: 1.2605 s
Train Loss*     : 0.0833 | Train Acc     : 0.9689
Valid Loss     : 0.0957 | Valid Acc     : 0.9656
EarlyStopping counter: 2 out of 4

Epoch: 31 cost time: 0.8130 s
Train Loss*     : 0.0813 | Train Acc     : 0.9679

Epoch: 32 cost time: 1.0113 s
Train Loss*     : 0.0942 | Train Acc     : 0.9650

Epoch: 33 cost time: 1.1963 s
Train Loss*     : 0.0753 | Train Acc     : 0.9720

Epoch: 34 cost time: 0.9386 s
Train Loss*     : 0.0887 | Train Acc     : 0.9692

Epoch: 35 cost time: 0.7903 s
Train Loss*     : 0.0798 | Train Acc     : 0.9708

Epoch: 36 cost time: 1.1937 s
Train Loss*     : 0.0791 | Train Acc     : 0.9708

Epoch: 37 cost time: 0.8869 s
Train Loss*     : 0.0747 | Train Acc     : 0.9718

Epoch: 38 cost time: 0.8786 s
Train Loss*     : 0.0832 | Train Acc     : 0.9683

Epoch: 39 cost time: 0.7434 s
Train Loss*     : 0.0923 | Train Acc     : 0.9653

Epoch: 40 cost time: 1.2690 s
Train Loss*     : 0.0798 | Train Acc     : 0.9712
Valid Loss     : 0.0805 | Valid Acc     : 0.9694
Validation loss decreased (0.083400 --> 0.080500).  Saving model ...

Epoch: 41 cost time: 0.7514 s
Train Loss*     : 0.0812 | Train Acc     : 0.9675

Epoch: 42 cost time: 0.7614 s
Train Loss*     : 0.0821 | Train Acc     : 0.9677

Epoch: 43 cost time: 1.1554 s
Train Loss*     : 0.0788 | Train Acc     : 0.9694

Epoch: 44 cost time: 0.9522 s
Train Loss*     : 0.0828 | Train Acc     : 0.9692

Epoch: 45 cost time: 1.0091 s
Train Loss*     : 0.0741 | Train Acc     : 0.9712

Epoch: 46 cost time: 1.0451 s
Train Loss*     : 0.0752 | Train Acc     : 0.9700

Epoch: 47 cost time: 0.8933 s
Train Loss*     : 0.0730 | Train Acc     : 0.9740

Epoch: 48 cost time: 1.0190 s
Train Loss*     : 0.0826 | Train Acc     : 0.9696

Epoch: 49 cost time: 1.0348 s
Train Loss*     : 0.0802 | Train Acc     : 0.9712

Epoch: 50 cost time: 1.3684 s
Train Loss*     : 0.0772 | Train Acc     : 0.9727
Valid Loss     : 0.0748 | Valid Acc     : 0.9710
Validation loss decreased (0.080500 --> 0.074800).  Saving model ...

Epoch: 51 cost time: 0.7675 s
Train Loss*     : 0.0783 | Train Acc     : 0.9707

Epoch: 52 cost time: 0.7836 s
Train Loss*     : 0.0834 | Train Acc     : 0.9696

Epoch: 53 cost time: 1.0781 s
Train Loss*     : 0.0787 | Train Acc     : 0.9701

Epoch: 54 cost time: 1.0367 s
Train Loss*     : 0.0761 | Train Acc     : 0.9715

Epoch: 55 cost time: 0.9504 s
Train Loss*     : 0.0754 | Train Acc     : 0.9707

Epoch: 56 cost time: 0.7613 s
Train Loss*     : 0.0735 | Train Acc     : 0.9733

Epoch: 57 cost time: 0.7540 s
Train Loss*     : 0.0833 | Train Acc     : 0.9701

Epoch: 58 cost time: 0.7669 s
Train Loss*     : 0.0792 | Train Acc     : 0.9704

Epoch: 59 cost time: 0.8338 s
Train Loss*     : 0.0712 | Train Acc     : 0.9734

Epoch: 60 cost time: 0.7654 s
Train Loss*     : 0.0763 | Train Acc     : 0.9703
Valid Loss     : 0.0761 | Valid Acc     : 0.9714
EarlyStopping counter: 1 out of 4

Epoch: 61 cost time: 0.7737 s
Train Loss*     : 0.0777 | Train Acc     : 0.9709

Epoch: 62 cost time: 0.7989 s
Train Loss*     : 0.0731 | Train Acc     : 0.9714

Epoch: 63 cost time: 0.9514 s
Train Loss*     : 0.0774 | Train Acc     : 0.9692

Epoch: 64 cost time: 0.7463 s
Train Loss*     : 0.0809 | Train Acc     : 0.9704

Epoch: 65 cost time: 0.8896 s
Train Loss*     : 0.0861 | Train Acc     : 0.9690

Epoch: 66 cost time: 1.3439 s
Train Loss*     : 0.0823 | Train Acc     : 0.9701

Epoch: 67 cost time: 1.4995 s
Train Loss*     : 0.0758 | Train Acc     : 0.9693

Epoch: 68 cost time: 0.8011 s
Train Loss*     : 0.0753 | Train Acc     : 0.9715

Epoch: 69 cost time: 1.1499 s
Train Loss*     : 0.0806 | Train Acc     : 0.9709

Epoch: 70 cost time: 1.0381 s
Train Loss*     : 0.0820 | Train Acc     : 0.9701
Valid Loss     : 0.0906 | Valid Acc     : 0.9677
EarlyStopping counter: 2 out of 4

Epoch: 71 cost time: 1.2310 s
Train Loss*     : 0.0741 | Train Acc     : 0.9722

Epoch: 72 cost time: 1.0783 s
Train Loss*     : 0.0746 | Train Acc     : 0.9719

Epoch: 73 cost time: 1.0101 s
Train Loss*     : 0.0743 | Train Acc     : 0.9715

Epoch: 74 cost time: 0.9146 s
Train Loss*     : 0.0808 | Train Acc     : 0.9689

Epoch: 75 cost time: 0.7339 s
Train Loss*     : 0.0804 | Train Acc     : 0.9703

Epoch: 76 cost time: 1.1931 s
Train Loss*     : 0.0740 | Train Acc     : 0.9709

Epoch: 77 cost time: 0.8227 s
Train Loss*     : 0.0770 | Train Acc     : 0.9698

Epoch: 78 cost time: 1.0866 s
Train Loss*     : 0.0730 | Train Acc     : 0.9726

Epoch: 79 cost time: 1.2161 s
Train Loss*     : 0.0689 | Train Acc     : 0.9752

Epoch: 80 cost time: 1.1932 s
Train Loss*     : 0.0764 | Train Acc     : 0.9719
Valid Loss     : 0.0833 | Valid Acc     : 0.9689
EarlyStopping counter: 3 out of 4

Epoch: 81 cost time: 1.2767 s
Train Loss*     : 0.0713 | Train Acc     : 0.9725

Epoch: 82 cost time: 0.7644 s
Train Loss*     : 0.0726 | Train Acc     : 0.9729

Epoch: 83 cost time: 0.9870 s
Train Loss*     : 0.0724 | Train Acc     : 0.9727

Epoch: 84 cost time: 0.7495 s
Train Loss*     : 0.0859 | Train Acc     : 0.9674

Epoch: 85 cost time: 1.0911 s
Train Loss*     : 0.0895 | Train Acc     : 0.9661

Epoch: 86 cost time: 1.2240 s
Train Loss*     : 0.0919 | Train Acc     : 0.9674

Epoch: 87 cost time: 0.7881 s
Train Loss*     : 0.0797 | Train Acc     : 0.9711

Epoch: 88 cost time: 1.0640 s
Train Loss*     : 0.0723 | Train Acc     : 0.9722

Epoch: 89 cost time: 0.7476 s
Train Loss*     : 0.0781 | Train Acc     : 0.9715

Epoch: 90 cost time: 1.1526 s
Train Loss*     : 0.0773 | Train Acc     : 0.9719
Valid Loss     : 0.0781 | Valid Acc     : 0.9712
EarlyStopping counter: 4 out of 4

Early stopping

################## Training is Done! #########################
Test:
Loss:    0.0802
Acc:    97.0435 | maf1:    95.3804 | mif1:    97.0435 | wf1:    97.0314

Training time is : 0:01:34.421276



